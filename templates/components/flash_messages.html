<!-- Flash Messages Component -->
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        <div class="flash-messages-container">
            {% for category, message in messages %}
                <div class="alert alert-{{ category }} alert-dismissible fade show flash-message" role="alert">
                    <div class="d-flex align-items-center">
                        <!-- Icon based on message type -->
                        {% if category == 'success' %}
                            <i class="fas fa-check-circle me-3 fa-lg"></i>
                        {% elif category == 'danger' %}
                            <i class="fas fa-exclamation-circle me-3 fa-lg"></i>
                        {% elif category == 'warning' %}
                            <i class="fas fa-exclamation-triangle me-3 fa-lg"></i>
                        {% elif category == 'info' %}
                            <i class="fas fa-info-circle me-3 fa-lg"></i>
                        {% endif %}
                        
                        <!-- Message Content -->
                        <div class="flex-grow-1">
                            <h6 class="alert-heading mb-1">
                                {% if category == 'success' %}
                                    Success!
                                {% elif category == 'danger' %}
                                    Error!
                                {% elif category == 'warning' %}
                                    Warning!
                                {% elif category == 'info' %}
                                    Info
                                {% endif %}
                            </h6>
                            <p class="mb-0">{{ message }}</p>
                        </div>
                        
                        <!-- Close Button -->
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                    
                    <!-- Progress Bar -->
                    <div class="progress mt-2" style="height: 3px;">
                        <div class="progress-bar bg-{{ category }}" role="progressbar" style="width: 100%"></div>
                    </div>
                </div>
            {% endfor %}
        </div>
        
        <!-- Auto-dismiss script -->
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const alerts = document.querySelectorAll('.flash-message');
                alerts.forEach(alert => {
                    // Auto dismiss after 5 seconds
                    setTimeout(() => {
                        const bsAlert = new bootstrap.Alert(alert);
                        bsAlert.close();
                    }, 5000);
                    
                    // Pause dismissal on hover
                    alert.addEventListener('mouseenter', function() {
                        const progressBar = this.querySelector('.progress-bar');
                        progressBar.style.animationPlayState = 'paused';
                    });
                    
                    alert.addEventListener('mouseleave', function() {
                        const progressBar = this.querySelector('.progress-bar');
                        progressBar.style.animationPlayState = 'running';
                    });
                });
            });
        </script>
        
        <style>
            .flash-messages-container {
                position: fixed;
                top: 80px;
                right: 20px;
                z-index: 9999;
                max-width: 400px;
                animation: slideInRight 0.3s ease-out;
            }
            
            .flash-message {
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                border: none;
                border-left: 4px solid;
                margin-bottom: 10px;
                animation: fadeIn 0.3s ease-out;
            }
            
            .flash-message.alert-success {
                border-left-color: #28a745;
                background: linear-gradient(135deg, rgba(40, 167, 69, 0.1) 0%, rgba(40, 167, 69, 0.05) 100%);
            }
            
            .flash-message.alert-danger {
                border-left-color: #dc3545;
                background: linear-gradient(135deg, rgba(220, 53, 69, 0.1) 0%, rgba(220, 53, 69, 0.05) 100%);
            }
            
            .flash-message.alert-warning {
                border-left-color: #ffc107;
                background: linear-gradient(135deg, rgba(255, 193, 7, 0.1) 0%, rgba(255, 193, 7, 0.05) 100%);
            }
            
            .flash-message.alert-info {
                border-left-color: #17a2b8;
                background: linear-gradient(135deg, rgba(23, 162, 184, 0.1) 0%, rgba(23, 162, 184, 0.05) 100%);
            }
            
            .flash-message .progress-bar {
                animation: progressBar 5s linear forwards;
            }
            
            @keyframes slideInRight {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(-20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            @keyframes progressBar {
                from {
                    width: 100%;
                }
                to {
                    width: 0%;
                }
            }
            
            @media (max-width: 768px) {
                .flash-messages-container {
                    left: 10px;
                    right: 10px;
                    max-width: none;
                    top: 70px;
                }
            }
        </style>
    {% endif %}
{% endwith %}